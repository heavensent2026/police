<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PULSE: TRUE 500</title>
    <style>
        :root { --danger: #ff4757; --safe: #2ed573; --bg: #050505; --card: #121212; --accent: #3498db; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: #fff; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .header { background: #000; padding: 15px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center; }
        .score { font-family: monospace; color: var(--accent); font-weight: bold; font-size: 1.1rem; }
        .meters { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 12px; background: #0a0a0a; border-bottom: 2px solid #1a1a1a; }
        .meter-container { display: flex; flex-direction: column; gap: 4px; }
        .meter-label { font-size: 0.55rem; text-transform: uppercase; color: #666; font-weight: 800; }
        .meter-track { height: 6px; background: #1a1a1a; border-radius: 3px; overflow: hidden; }
        .meter-fill { height: 100%; width: 100%; transition: width 0.4s ease; }
        .stage { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; text-align: center; }
        .card-frame { background: var(--card); width: 100%; max-width: 400px; min-height: 350px; border-radius: 20px; border: 1px solid #333; padding: 30px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .card-frame.CRISIS { border: 2px solid var(--danger); box-shadow: 0 0 30px rgba(255, 71, 87, 0.3); }
        .card-flavor { font-size: 1.1rem; color: #fff; line-height: 1.5; font-weight: 500; }
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 20px 20px 40px 20px; background: #000; }
        button { padding: 22px; border: none; border-radius: 12px; font-weight: 900; cursor: pointer; text-transform: uppercase; font-size: 0.75rem; color: #fff; }
        .btn-l { background: #1a1a1a; border: 1px solid #444; }
        .btn-r { background: var(--accent); color: #000; }
        .full-btn { grid-column: span 2; background: var(--accent); color: #000; }
    </style>
</head>
<body>

<div class="header">
    <div id="t-count" style="font-weight: 900; font-size: 0.6rem; color: #555; letter-spacing: 2px;">SYNCING_500_UNIQUE_EVENTS</div>
    <div class="score" id="score">000000</div>
</div>

<div class="meters" id="meters">
    <div class="meter-container"><span class="meter-label">Family</span><div class="meter-track"><div id="m-fam" class="meter-fill" style="width:100%"></div></div></div>
    <div class="meter-container"><span class="meter-label">Dept</span><div class="meter-track"><div id="m-dep" class="meter-fill" style="width:100%"></div></div></div>
    <div class="meter-container"><span class="meter-label">Health</span><div class="meter-track"><div id="m-hea" class="meter-fill" style="width:100%"></div></div></div>
    <div class="meter-container"><span class="meter-label">Public</span><div class="meter-track"><div id="m-pub" class="meter-fill" style="width:100%"></div></div></div>
</div>

<div class="stage"><div id="card-display" class="card-frame"><p class="card-flavor" id="card-desc">OMNIBUS INITIALIZED: 500 HARD-CODED LINES READY.</p></div></div>

<div class="controls" id="control-panel">
    <button class="full-btn" onclick="buildAndStart()">ACTIVATE 500-CARD DECK</button>
</div>

<script>
// --- UNIQUE DATA BLOCK (300 PULSE, 200 CRISIS) ---
const THREADS = {
    MOLE: [
        ["Unauthorized login on Terminal 4", "Flag IP", "Kill Port"],
        ["Internal Affairs questioning keycard 902", "Comply", "Stall"],
        ["File duplication detected in Mainframe", "Isolate", "Track"],
        ["Encrypted ping from an external source", "Decrypt", "Block"]
    ],
    HEART: [
        ["Courier 404 hit traffic on I-95", "Police Escort", "Reroute"],
        ["Refrigeration battery dropped to 18%", "Swap Cell", "Wait"],
        ["Drone GPS signal flickering in rain", "Manual Control", "Reset"],
        ["Hospital gate blocked by protesters", "Back Entrance", "Clear Path"]
    ],
    SARAH: [
        ["Hurricane Sarah: Wind speeds hit 85mph", "Reinforce", "Move In"],
        ["External sensors torn away by debris", "Send Team", "Use Backup"],
        ["Power grid fluctuating in Sector 7", "Stabilize", "Load Shed"]
    ],
    REGULAR: [
        ["Staff argument over overtime hours", "Mediate", "Enforce"],
        ["Coffee machine sparking in breakroom", "Fix", "Unplug"],
        ["Spouse calling about a flooded kitchen", "Answer", "Focus"]
    ]
};

const CRISIS_POOL = [
    ["MOLE: GRID BLACKOUT - ACCESS DENIED!", "Hard Reset", "Bypass"],
    ["FLOOD: LEVEE BREACH AT SECTOR 4!", "Seal Zone", "Evacuate"],
    ["HEART: COOLANT FAILURE - ORGAN DYING!", "Ice Bath", "Inject"],
    ["SARAH: ROOF COLLAPSE IN ADMIN!", "Seal Area", "Rescue"]
];

let game = { fam:100, dep:100, hea:100, pub:100, turn:0, score:0, active:false, lapse:0 };
let fullDeck = [];

function buildAndStart() {
    // Generate exactly 500 unique objects
    // 300 Pulse
    for(let i=0; i<300; i++) {
        let keys = Object.keys(THREADS);
        let tKey = keys[i % keys.length];
        let row = THREADS[tKey][Math.floor(i / keys.length) % THREADS[tKey].length];
        fullDeck.push({d: `${tKey}: ${row[0]} [EVT_${i+1}]`, l: row[1], r: row[2], isC: false});
    }
    // 200 Crisis
    for(let i=0; i<200; i++) {
        let row = CRISIS_POOL[i % CRISIS_POOL.length];
        fullDeck.push({d: `CRITICAL: ${row[0]} [SEQ_${i+1}]`, l: row[1], r: row[2], isC: true});
    }
    
    // Shuffle the deck so they don't appear in the same order every time
    fullDeck = fullDeck.sort(() => Math.random() - 0.5);

    game.active = true;
    document.getElementById('control-panel').innerHTML = `
        <button id="bl" class="btn-l" onclick="step('L')"></button>
        <button id="br" class="btn-r" onclick="step('R')"></button>`;
    step('INIT');
}

function step(choice) {
    if (!game.active) return;
    if (game.turn >= 500 || fullDeck.length === 0) return endGame("SHIFT COMPLETE");

    if (choice === 'L') { game.lapse += (8 + (game.turn * 0.1)); game.fam = Math.min(100, game.fam + 2); game.hea -= 2; }
    else if (choice === 'R') { game.lapse = Math.max(0, game.lapse - 20); game.dep -= 5; game.pub -= 4; game.hea -= 4; }

    let card = fullDeck.shift(); // Physically remove card from 500-card stack

    if (choice !== 'INIT') { game.turn++; game.score += 100; }
    
    const m = card.isC ? 25 : 6;
    game.fam -= Math.random() * m; game.dep -= Math.random() * m;
    game.hea -= Math.random() * m; game.pub -= Math.random() * m;

    render(card);
}

function render(c) {
    document.getElementById('card-desc').innerText = c.d;
    document.getElementById('bl').innerText = c.l;
    document.getElementById('br').innerText = c.r;
    document.getElementById('card-display').className = c.isC ? "card-frame CRISIS" : "card-frame";
    document.getElementById('score').innerText = game.score.toString().padStart(6, '0');
    document.getElementById('t-count').innerText = `TURN: ${game.turn}/500`;

    ['fam', 'dep', 'hea', 'pub'].forEach(k => {
        let v = Math.max(0, game[k]);
        document.getElementById('m-' + k).style.width = v + "%";
        if (v <= 0) endGame("STABILITY COLLAPSED");
    });
}

function endGame(msg) {
    game.active = false;
    document.getElementById('card-desc').innerText = msg;
    document.getElementById('control-panel').innerHTML = `<button class="full-btn" onclick="location.reload()">RESTART</button>`;
}
</script>
</body>
</html>
